version: "3.1"

rules:

- rule: Respond to negative mood and offer booking
  steps:
    - intent: mood_negative
    - action: utter_support
    - action: utter_offer_help

- rule: Start appointment form
  steps:
    - action: utter_offer_help
    - intent: affirm
    - action: appointment_form
    - active_loop: appointment_form

- rule: Submit appointment form
  condition:
    - active_loop: appointment_form
  steps:
    - action: appointment_form
    - active_loop: null
    - action: action_confirm_appointment

- rule: AI fallback (OpenAI)
  condition:
    - active_loop: null
  steps:
    - intent: fallback
    - action: action_openai_fallback

- rule: Say goodbye
  steps:
    - intent: goodbye
    - action: utter_goodbye

- rule: Bot challenge
  steps:
    - intent: bot_challenge
    - action: utter_iamabot